<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>一桶金·注册享588元红包</title>
    <script src="../fastclick.js"></script>
    <script src="../jquery.min.js"></script>
    <script src="../../common.js"></script>


    <style type="text/css">
        html, body, div, input, li, img, span {
            padding: 0;
            margin: 0;
        }

        html, body {
            width: 100%;
            height: 100%;
        }

        body {
            position: relative;
            width: 7.5rem;
            height: 27.3rem;
            background: url("img/jiaojing.png") no-repeat;
            background-size: cover;
        }

        img {
            display: block;
            width: 100%;
        }

        .content {
            margin-top: 4rem;
            width: 100%;
            height: 6.6rem;
            position: relative;
            padding-top: 0.35rem;
            box-sizing: border-box;
            /*background: url(img/dx2.png) no-repeat 0 0;*/
            /*background-size: cover;*/
        }

        .content > div {
            padding: 1rem;
            height: 100%;
            width: 5rem;
            margin: 0 auto;
            position: relative;
        }

        .area {
            height: 0.7rem;
            width: 5rem;
            margin-bottom: 0.2rem;
            position: relative;
        }

        .area input {
            float: left;
            margin-bottom: 0;
        }

        .numVali {
            width: 1.7rem;
            border-radius: 0.08rem;
            background-color: white;
            font-size: 0.24rem;
            color: #FFCB2C;
            position: absolute;
            right: 0;
            font-size: 0.28rem;
            text-align: center;
            line-height: 0.7rem;
            background-color: #20222D;
        }

        .shade {
            border-radius: 0.08rem;
            height: 0.7rem;
            width: 2rem;
            background: rgba(250, 250, 250, 0.6);
            display: none;
            position: absolute;
            top: 0;
            left: 3rem;
            z-index: 99;
        }

        .Verification {
            height: 0.7rem;
            width: 100%;
        }

        .contentDown {
            height: 15rem;
            width: 100%;
            /*background: url(3@2x.png) no-repeat 0 0;*/
            position: relative;
            background-size: cover;
        }

        .contentDown img {
            display: block;
            height: 0.74rem;
            width: 2.2rem;
            position: absolute;
            top: 4.4rem;
            left: 50%;
            margin-left: -1.1rem;
        }

        span, .imgVali {
            display: block;
            height: 0.7rem;
            width: 2rem;
            float: left;
        }

        input {
            display: block;
            width: 5rem;
            height: 0.7rem;
            border-radius: 0.1rem;
            outline: none;
            border: 0;
            -webkit-appearance: none;
            font-size: 0.24rem;
            text-indent: 0.6rem;
            margin-bottom: 0.2rem;
            font-family: 微软雅黑;
            color: #999999;
            border:0.01rem solid #FECB2C ;
        }


        .check {
            height: 0.28rem;
            width: 5rem;
            font-size: 0.24rem;
            font-size: 0.24rem;
            font-family: 微软雅黑;
            margin-top: 0.05rem;
            margin-bottom: 0.2rem;
            display: flex;
            align-items: center;
        }

        .pick {
            height: 0.7rem;
            width: 3rem;
            background-color: #20222D;
            text-align: center;
            line-height: 0.7rem;
            position: absolute;
            top: -1.2rem;
            border-radius: 0.1rem;
            left: 64%;
            margin-left: -2.63rem;
            /*background: url(img/pick.png) no-repeat 0 0;*/
            /*background-size: contain;*/
            font-size: 0.34rem;
            color: #FFCB2C;
        }

        .tick {
            height: 0.28rem;
            width: 0.28rem;
            background: url(img/nobingo.png) no-repeat 0 0;
            background-size: contain;
            float: left;
            margin-right: 0.14rem;
        }

        .inform, .tuInform {
            width: 6.4rem;
            height: 3.4rem;
            position: absolute;
            left: 50%;
            margin-left: -3.2rem;
            background-color: white;
            z-index: 99;
            display: none;
            box-sizing: border-box;
            padding-top: 0.4rem;
            border: 1px solid #cacaca;
            border-radius: 0.12rem;
        }

        .tuInform {
            height: 3.7rem;
        }

        .inform p:first-child, .tuInform p {
            font-size: 0.32rem;
            color: #666666;
            height: 0.32rem;
            display: block;
            width: 100%;
            text-align: center;
            margin-bottom: 0.5rem;
            line-height: 0.32rem;
        }

        /*.tuInform{
          display: block;
        }*/
        .tuInform p {
            margin-bottom: 0.6rem;
            margin-top: 0;
        }

        .imageNum {
            width: 100%;
            height: 0.88rem;
            box-sizing: border-box;
            padding: 0 0.5rem;
            margin-bottom: 0.6rem;

        }

        .imageNum input {
            float: left;
            box-sizing: border-box;
            padding: 0.28rem 0.24rem;
            width: 3rem;
            height: 0.86rem;
            margin-right: 0.2rem;
            border-radius: 0.06rem;
            border: 1px solid #cacaca;
            margin-bottom: 0;
            margin-top: 1px;
        }

        .imageNum div {
            float: left;
            width: 2rem;
            height: 0.88rem;
            background-color: yellow;
            border-radius: 0.06rem;
        }

        .sure {
            width: 100%;
            height: 0.86rem;
            border-top: 1px solid #cacaca;
        }

        .conform {
            display: block;
            width: 100%;
            min-height: 0.32rem;
            line-height: 0.32rem;
            font-size: 0.32rem;
            text-align: center;
            color: #666666;
        }

        .know {
            width: 100%;
            position: absolute;
            bottom: 0.1rem;
            height: 0.88rem;
            line-height: 0.88rem;
            text-align: center;
            color: #ff5133;
            border-top: 1px solid #cacaca;
            font-size: 0.32rem;

        }

        .dianji {
            position: relative;
        }

        .cancle, .mySure {
            float: left;
            width: 49%;
            height: 0.86rem;
            text-align: center;
            line-height: 0.86rem;
            font-size: 0.32rem;
            color: #666666;
            font-family: 微软雅黑;
        }

        .mySure {
            color: #FF5E33;
        }

        .cancle {
            border-right: 0.02rem solid #cacaca;
        }

        #test {
            width: 100%;
            height: 100%;
        }
        #phone::after {
            content: '';
            display: inline-block;
            width: 3rem  ;
            height: 3rem;
            background: url("img/icon-phone.png") no-repeat;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1000000;
        }
        .passT{
            font-family: 微软雅黑;
            font-size: 0.22rem;
            color: #2c9afc;
            display: block;
            height: 0.22rem;
            line-height: 0.22rem;
            text-align: center;
            margin-bottom: 0.21rem;
        }
        #numVeri {
            width: 3.2rem;
        }
        .img1,.img2,.img3 {
            width: 0.24rem;
            height: 0.36rem;
        }
        .img1 {
            position: absolute;
            top: 14%;
            left: 17%;
        }
        .img2 {
            width: 0.30rem;
            height: 0.34rem;
            position: absolute;
            top: 25.5%;
            left: 17%;
        }
        .img3 {
            width: 0.31rem;
            height: 0.36rem;
            position: absolute;
            top: 36%;
            left: 17%;
        }

    </style>
</head>
<body>
<!--<img src="img/dx1.png">-->
<div class="content">
    <div>
        <input maxlength="11" type="text" name="" placeholder="请输入手机号" id="phone">
        <div class="area"><input maxlength="6" type="" name="" placeholder="请输入验证码" class="Verification"
                                 id="numVeri"><span class="numVali">获取验证码</span>
            <div class="shade"></div>
        </div>
        <input type="password" name="" placeholder="请设置登录密码" id="cipher" style="margin-bottom: 0;">
        <div class="img1"><img src="img/icon-phone.png" alt=""></div>
        <div class="img2"><img src="img/icon-baozhang.png" alt=""></div>
        <div class="img3"><img src="img/icon-safe.png" alt=""></div>
        <!-- <div class="check"><div class="tick"></div><font style="color: white;opacity: 0.6;">我已阅读并同意</font><font style="color: white;opacity: 1;" class="yitongjin">《一桶金使用协议》</font></div> -->
        <p style="font-size: 0.22rem;color: #808080; margin-top: 0.1rem ; margin-bottom: 0.6rem;">密码长度不小于6位字符，且由字符和数字组成</p>
        <p class="passT">已有账户,前往APP登录 ></p>
    </div>
</div>
<div class="dianji">
    <!--<img src="img/dx3.png">-->
    <div class="pick"></div>
    <div class="pick">立即注册</div>
</div>
<div class="inform" >
    <p style="font-size: 0.32rem;color: #666666;height:0.32rem;display: block;width: 100%;text-align: center;margin-bottom: 0.5rem;line-height: 0.32rem;">
        提示</p>
    <p class="conform"></p>
    <div class="know">我知道了</div>
</div>
<div class="tuInform">
    <p>输入图形验证码</p>
    <div class="imageNum">
        <input type="text" name="" placeholder="请输入">
        <div><img id="test" src=""></div>
    </div>
    <div class="sure">
        <div class="cancle">取消</div>
        <div class="mySure">发送</div>
    </div>
</div>
</body>
<script type="text/javascript">
    (function () {
        var docEl = document.documentElement;
        var width = docEl.getBoundingClientRect().width;
        if (width > 450) {
            width = 450
        }
        ;
        var rootRem = width / 375 * 50;
        docEl.style.fontSize = rootRem + 'px';
    })();
</script>
<script type="text/javascript">
    $(function(){

        // var url = 'https://www.etongjin.net/user'
        //生成唯一UUID
        if(localStorage.getItem("did") == null){
            function guid() {
                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                    var r = Math.random()*16|0, v = c == 'x' ? r : (r&0x3|0x8);
                    return v.toString(16);
                });
            }
            var did = guid();
            localStorage.setItem("did",did);
            console.log(did);
        }
        console.log(localStorage.getItem("did"));



        var getImage = function(){
            $.ajax({
                async: true,
                type: 'get',
                url: url+"/user/generate",
                headers:{"uid":" e9fd37c2df6ca80f9a73b67ba06a0d1d2962e8e1e6a871adfd"},
                timeout: 5000,   //超时时间
                data:{"did":localStorage.getItem("did"),"uri":"channelSendCode"},
                complete:function (data) {
                    $("#test").attr('src', data.responseText);
                },
                error:function(){

                }
            });
        }

        $("#test").click(function(){
            getImage();
        })
        $(".passT").click(function(){
            if(isAndroid_ios()){
                location.href = 'http://a.app.qq.com/o/simple.jsp?pkgname=com.xiongmao.yitongjin&ckey=CK1379634116040';
            }else{
                location.href = 'https://itunes.apple.com/cn/app/yi-tong-jin/id1024323697?mt=8';
            }
        })

        $(".pick").click(function(){
            var phone = $("#phone").val();
            var numVeri = $("#numVeri").val();
            var cipher = $("#cipher").val();
            /*var recommend = $("#recommend").val();*/
            var windowHeight = $(window).scrollTop();
            console.log(windowHeight);
            $(".inform").css("top",windowHeight +"px");
            $(".tuInform").css("top",windowHeight +"px");
            if(!(/^1[3|4|5|6|7|8|9][0-9]\d{4,8}$/.test(phone))){
                $(".inform").css("display","block");
                $(".conform").text("手机号码格式不正确");
                return;
            }else if(numVeri == ""){
                $(".inform").css("display","block");
                $(".conform").text("请填写手机验证码");
                return;
            }else if(cipher.length < 6){
                $(".inform").css("display","block");
                $(".conform").text("密码格式错误");
                return;
            }

            $.ajax({
                type: 'POST',
                url: url+"/user/shareSignup",
                data:{"telphone":phone,"password":cipher,"code":numVeri,"channel":"jiaojing"},
                success:function(data){ //返回json结果
                    var phone = $("#phone").val();
                    if(data.code == 200){
                        window.location.href="https://www.etongjin.net/app4.0/Invitation/newDown.html?"+phone+"";
                    }
                    if(data.code == 400){
                        $(".inform").css("display","block");
                        $(".conform").text(data.msg);
                    }
                },
                error:function(){

                }
            });


        })
        function isAndroid_ios(){
            var u = navigator.userAgent, app = navigator.appVersion;
            var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
            var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
            return isAndroid==true?true:false;
        }


        //数字验证码点击
        $(".numVali").click(function(){
            var phone = $("#phone").val();
            var windowHeight = $(window).scrollTop();
            console.log(windowHeight);
            $(".inform").css("top",windowHeight +"px");
            $(".tuInform").css("top",windowHeight +"px");
            if(!(/^1[3|4|5|6|7|8|9][0-9]\d{4,8}$/.test(phone))){
                $(".inform").css("display","block");
                $(".conform").text("手机号码格式不正确");
                /*$(".shade").css("display","none");*/
                return;
            }
            $(".shade").css("display","block");
            $(".numVali").css("color","#ffffff");
            var time = 60;
            $(".numVali").text('('+ time +')秒后重发');
            var timer = setInterval(function(){
                time = time - 1;
                $(".numVali").text('('+ time +')秒后重发');
                if(time == 0){
                    $(".numVali").css("color","#FFCB2C");
                    $(".numVali").text("发送验证码");
                    $(".shade").css("display","none");
                    clearInterval(timer);
                    return;
                }
            },1000);

            $.ajax({
                type: 'POST',
                url: url+"/user/channelSendCode/e9fd37c2df6ca80f9a73b67ba06a0d1d2962e8e1e6a871adfd",
                headers:{"uid":"e9fd37c2df6ca80f9a73b67ba06a0d1d2962e8e1e6a871adfd"},
                data:{"phone":phone,"did":localStorage.getItem("did")},
                success:function(data){
                    //返回json结果
                    if(data.code == 200){

                    };
                    if(data.code ==400){
                        $(".inform").css("display","block");
                        $(".conform").text(data.msg);//提示用户已被注册
                        setTimeout(function () {
                            if(isAndroid_ios()){
                                location.href = 'http://a.app.qq.com/o/simple.jsp?pkgname=com.xiongmao.yitongjin&ckey=CK1379634116040';
                            }else{
                                location.href = 'https://itunes.apple.com/cn/app/yi-tong-jin/id1024323697?mt=8';
                            }
                        },2000)
                    }
                    if(data.code == 505){
                        getImage();
                        $(".tuInform").css("display","block");
                    }
                },
                error:function(){
                    $(".inform").css("display","block");
                    $(".conform").text("验证码错误");
                }
            })
        })

        $(".mySure").click(function(){
            var tuMsg = $(".imageNum input").val();
            console.log(tuMsg);
            $.ajax({
                type: 'POST',
                url: url+"/user/verify" ,
                headers:{"uid":"e9fd37c2df6ca80f9a73b67ba06a0d1d2962e8e1e6a871adfd"},
                data: {"code": tuMsg, "did":localStorage.getItem("did")} ,
                success: function (data) { //返回json结果
                    if(data.code == 200){
                        $(".tuInform").css("display","none");
                    }else{
                        $(".inform").css("display","block");
                        $(".conform").text("验证码错误");
                        getImage();
                    }
                }
            });
        })

        $(".cancle").click(function(){
            $(".tuInform").css("display","none");
        })


        $(".goTop").click(function(){
            var speed=500;//滑动的速度
            $('body,html').animate({ scrollTop: 0 }, speed);
            return false;
        })
        var flag = 0;
        $(".tick").click(function(){
            if(flag == 0){
                $(this).css("background-image","url(img/bingo.png)");
                flag = 1;
            }else if(flag == 1){
                $(this).css("background-image","url(img/nobingo.png)");
                flag = 0;
            }
        })

        $(".know").click(function(){
            $(".inform").css("display","none");
        })


        $(".yitongjin").click(function(){
            window.location.href = "http://www.etongjin.com.cn/webapp/agreement.html";
        })

    })





</script>
</html>