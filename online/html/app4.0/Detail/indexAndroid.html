<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<script src="../js/jquery.min.js" type="text/javascript"></script>
<script src="../js/rem.js" type="text/javascript"></script>
<meta http-equiv="content-type" content="txt/html; charset=utf-8" />
<meta content="telephone=no" name="format-detection" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#de3100">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<!-- <link href="${weburl}${theme_dir}/appCss/global.css" rel="stylesheet" type="text/css" />
<link href="${weburl}${theme_dir}/appCss/webpp_pp.css" rel="stylesheet" type="text/css" /> -->
<link rel="stylesheet" href="lay/layui.css" rel="stylesheet" type="text/css">
<script src="lay/layui.js"></script>
<head>
	<title>项目详情</title>
</head>

<style type="text/css">
	  body,html,ul,li,p,span,a,div{
      padding:0;
      margin:0;
    }
    html,body{
      width: 100%;
      height: 100%;
      font-family: 微软雅黑;
      
    }
    body{
    	position: relative;
    	background-color: #f9f9f9;
    }
    a:hover, a:visited, a:link, a:active {
    	color:black;
	}
    .head{
      height: 0.98rem;
      width: 100%;
      border-top:1px solid #eee;
      border-bottom: 1px solid #eee;
      background-color: white;
      display: flex;
      display: -webkit-flex;
      /* position:fixed;
      z-index:99;
      top: 0;
      left:0; */
    }
    .head div{
        flex-grow:1;
        font-size: 0.3rem;
        
    }
    .head div a{
      display: block;
      width: 1.34rem;
      font-size:0.32rem;
      height: 98%;;
      
    }
    .dianji{
    	color:#FF5E33; 
    	border-bottom: 0.02rem solid #FF5E33;
    }
    .head div,.head div a{
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .proModule{
      background-color: white;
      margin-bottom: 0.24rem;
    }
    .proTop{ 
      height: 0.9rem;
      width: 100%;
      font-size: 0.32rem;
      text-indent: 0.24rem;
      color:#333333;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #eee;
    }
    .proCon{
      width: 100%;
      box-sizing: border-box;
      padding:0.24rem;
      font-size:0.28rem;
      color:#666666;
    }
    .wzIndent{ 
    	text-indent: 0.3rem;
    }
    table tr:nth-child(4){
      height: 0.94rem;
    }
    table tr:nth-child(4) td:last-child{
      padding:0 0.24rem;
    }
    tr{
      height:0.7rem;
      width: 100%;
    }
    tr td:first-child{
      width: 40%;
      text-align: center;
    }
    tr td:last-child{
      text-align: center;
    }
    .proSafe div{
      height: 0.46rem;
      width: 100%;
      padding:0.12rem 0;
      display: flex;
      font-size: 0.28rem;
      align-items: center;
    }
    .proSafe div span{
      display: block;
      height: 0.46rem;
      width: 0.46rem;
      background-color: #ddd;
      margin-right: 0.26rem;
      background:url(img/icon_hkbz.png) no-repeat 0 0;
      background-size: contain;
    }
    .proImg{
      height: 1.2rem;
      width: 1.56rem;
      margin-right: 0.26rem;
      margin-bottom: 0.26rem;
      background-color: #eee;
    }
    
    .page{margin-top: 30px;}
    .tabs{background: #fff;}
    .row{
       min-height: 1.5rem;
       line-height: 1.5rem;
       width:100%;
       padding: 5px 5px;
     }
    .row span{
    	display:inline-block;
    	width:33%;
    	text-align:center;
    }
    .row div{
      display: inline-block;
    }
    
    .tzRecond div span{
    	display:inline-block;
    	width:33%;
    	text-align:center;
    }
    
</style>

<script type="text/javascript">

    $(function(){
        var u = navigator.userAgent, app = navigator.appVersion;   
        var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器   
        var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端   

        console.log(navigator.userAgent);
/*
          if(navigator.userAgent.indexOf('iPhone')>=0 ){

          }else{
              //注册事件监听
              alert(11111);
              function setupWebViewJavascriptBridge(callback) {

                  if (window.WebViewJavascriptBridge) {
                      callback(WebViewJavascriptBridge)
                  }else{
                      document.addEventListener(
                          'WebViewJavascriptBridgeReady'
                          , function() {
                              callback(WebViewJavascriptBridge)
                          },
                          false
                      );
                  }
              }

             setupWebViewJavascriptBridge(function(bridge) {
               bridge.init(function(message, responseCallback) {
                   var responseData = '默认接收收到来自Java的数据，回传数据给你';
                   responseCallback(responseData);
               });

              
               bridge.callHandler('getUserTokenAndUUID',"123456",function(responseData) {
                    console.log(responseData);
                    var responseData = JSON.parse(responseData);
                    token = responseData.token;
                    uid = responseData.uuid;
                    channel = responseData.channel;
                    borrowId = parseInt(responseData.borrowId);
                    getDetail(uid,borrowId);
               });
          }
        }
*/
          if(isAndroid){  
            //注册事件监听
              function setupWebViewJavascriptBridge(callback) {

                  if (window.WebViewJavascriptBridge) {
                      callback(WebViewJavascriptBridge)
                  }else{
                      document.addEventListener(
                          'WebViewJavascriptBridgeReady'
                          , function() {
                              callback(WebViewJavascriptBridge)
                          },
                          false
                      );
                  }
              }

             setupWebViewJavascriptBridge(function(bridge) {
               bridge.init(function(message, responseCallback) {
                   var responseData = '默认接收收到来自Java的数据，回传数据给你';
                   responseCallback(responseData);
               });

              
               bridge.callHandler('getUserTokenAndUUID',"123456",function(responseData) {
                    console.log(responseData);
                    var responseData = JSON.parse(responseData);
                    token = responseData.token;
                    uid = responseData.uuid;
                    channel = responseData.channel;
                    borrowId = parseInt(responseData.borrowId);
                    getDetail(uid,borrowId);
               }
             );

           })

        }
        /*if(isiOS){
          function setupWebViewJavascriptBridge(callback) {

            if (window.WebViewJavascriptBridge) { return callback(WebViewJavascriptBridge); }
            if (window.WVJBCallbacks) { return window.WVJBCallbacks.push(callback); }
            window.WVJBCallbacks = [callback];
            var WVJBIframe = document.createElement('iframe');
            WVJBIframe.style.display = 'none';
            WVJBIframe.src = 'wvjbscheme://__BRIDGE_LOADED__';
            document.documentElement.appendChild(WVJBIframe);
            setTimeout(function() { document.documentElement.removeChild(WVJBIframe) }, 0)
            }
            setupWebViewJavascriptBridge(function(bridge) {                                
              bridge.callHandler('getUserTokenAndUUID',function callback(response) {

                
                token = response.token;
                uid = response.uuid;
                channel = response.channel;
                borrowId = parseInt(response.borrowId);
                getDetail(uid,borrowId);
              })   
          });
        }*/

      var getDetail =function(uid,borrowId){
        $.ajax({
          type: 'POST',
          url: "http://47.etongjin.net:8081/borrow/getBorrowDetail" ,
          headers:{"uid":uid},
          data:{"id":borrowId},
          success:function(data){
            if(data.code == 200){
              var data =data.data;
              
              if( data.borrowFlag == 'oldBorrow' ){
                  $(".noRegistration").css("display","none");
                  $(".registration").css("display","none");
                  $(".oledpage").css("display","block");
                  $(".tzRecond").css("display","none");
                }else{
                  $(".oledpage").css("display","none");
                  if( data.use != "0"){
                    $(".noRegistration").css("display","none");
                    $(".registration").css("display","block");
                    $(".tzRecond").css("display","none");
                  }else{
                    $(".noRegistration").css("display","block");
                    $(".registration").css("display","none");
                    $(".tzRecond").css("display","none");
                  }
                }
                    $("#xmsm").addClass("dianji");
                    $("#xmsm").css("color","#FF5E33");
                    $("#tzjl").removeClass("dianji");
                    $("#tzjl").css("color","black");;



              //项目详情
              $("#xmsm").click(function(){
                if( data.borrowFlag == 'oldBorrow' ){
                  $(".noRegistration").css("display","none");
                  $(".registration").css("display","none");
                  $(".oledpage").css("display","block");
                  $(".tzRecond").css("display","none");
                }else{
                  $(".oledpage").css("display","none");
                  if( data.use != "0"){
                    $(".noRegistration").css("display","none");
                    $(".registration").css("display","block");
                    $(".tzRecond").css("display","none");
                  }else{
                    $(".noRegistration").css("display","block");
                    $(".registration").css("display","none");
                    $(".tzRecond").css("display","none");
                  }
                }
                    $("#xmsm").addClass("dianji");
                    $("#xmsm").css("color","#FF5E33");
                    $("#tzjl").removeClass("dianji");
                    $("#tzjl").css("color","black");;
              });

              localStorage.setItem("borrowId",borrowId);
              localStorage.setItem("uid",uid);


              $(".finance_company").text(data.financeCompany);
              $(".ficAccount").text(data.ficAccount);
              $(".timeLimitDay").text(data.timeLimitDay + "天");
              $(".loan_usage").text(data.loanUsage);
              $(".payment").text(data.payment);

              //图片加载
              var arrimg = data.img;
              for(var i = 0;i<arrimg.length;i++){
                  if(arrimg[i]==''||arrimg[i]==null||typeof(arrimg[i])==undefined){
                    arrimg.splice(i,1);
                      i=i-1;
                  }
              }
              var imgstr = "";
                for(var i = 0; i < arrimg.length ; i++){
                  var proImg = $("<img class='proImg' src='"+arrimg[i]+"' />");
                  imgstr += arrimg[i]+",";
                  if((i + 1)%4 == 0){
                    proImg.css("margin-right","0px");
                  }
                  $(".proConImg").append(proImg);
                }
                imgstr = imgstr.substring(0, imgstr.length-1);
               
                var imgs = document.getElementsByClassName('proImg');
                for (var i = 0; i < imgs.length; i++) {
                    imgs[i].onclick = function (i) {
                        return function () {
                             location.href = "index.html?app_native=detailImg&index=" + i +"&images=" + arrimg[0] + "&images=" + arrimg[1] +
                             "&images=" + arrimg[2] + "&images=" + arrimg[3] + "&images=" + arrimg[4] +"&images=" + arrimg[5] +"&images=" + arrimg[6] +"&images=" + arrimg[7] ;
                             /* +"," + imgs[1] +"," 
                                + imgs[2] + "," + imgs[3] +"," + imgs[4] +"," + imgs[5] +"," + imgs[6] +","
                                + imgs[7]  ; */
                            /* console.log("index.html?app_native=detailImg&index=" + i +"&images=" + "$borrow.imgurl1" +"," + "$borrow.imgurl2" +"," 
                                + "$borrow.imgurl3" + "," + "$borrow.imgurl4" +"," + "$borrow.imgurl5" +"," + "$borrow.imgurl6" +"," + "$borrow.imgurl7" +","
                                +"$borrow.imgurl8"); */
                        }
                    } (i); //利用IIFE实现函数闭包，将i作为参数传入即可
                }
            }
          }
        })
      }
    })
    
  
</script>


<body>
   <!-- <input id="id" name="id" value="$borrow.id" type="hidden" /> -->
	<div class="head">
      <div class="proDes"><a  id="xmsm" class="dianji">项目说明</a></div>
      <div class="record"><a  id="tzjl">投资记录</a></div>
  </div>
  
  <div  class="oledpage" style="padding:0 25px;display: none;">
		  <img src=""  alt="" class="massage" width="180">
  </div>

<!-- 注册用户 -->
  <div class="registration">
	  <div class="proModule" >
	      <div class="proTop">
	        项目概论
	      </div>
	      <div class="proCon wzIndent">
	        本项目是一桶金围绕核心企业，为上下游中小企业提供资金支持和服务的一款供应链金融产品。这款产品既有效解决了中小企业融资难的问题，提高了企业的资金利用率，又帮助核心企业扩大了资产规模。项目真实可靠，还款稳定。是投资者可以放心购买的高安全性优质产品。
	      </div>
	  </div>
	  <div class="proModule">
	      <div class="proTop">
	        产品详情
	      </div>
	      <div class="proCon">
	        <table  border="1" bordercolor="#eee" style="border-collapse:collapse;width: 100%;">
	          <tr>
	            <td>融资企业</td><td class="finance_company"></td>
	          </tr>
	          <tr>
	            <td>借款额度</td><td class="ficAccount"></td>
	          </tr>
	          <tr>
	            <td>借款期限</td><td class="timeLimitDay">天</td>
	          </tr>
	          <tr>
	            <td>借款用途</td><td class="loan_usage"></td>
	          </tr>
	          <tr>
	            <td>还款来源</td><td class="payment"></td>
	          </tr>
	        </table>
	      </div>
	  </div>
	
	  <div class="proModule">
	      <div class="proTop">
	        还款保障
	      </div>
	      <div class="proCon proSafe">
	        <div><span></span>融资企业销售回款</div>
	        <div><span></span>核心企业无条件本息担保</div>
	      </div>
	  </div>
	
	  <div class="proModule">
	      <div class="proTop">
	        核心企业简介
	      </div>
	      <div class="proCon wzIndent">
	        核心企业坐落于闻名中外的“世界木雕之都”——浙江省东阳市。是东阳市首屈一指的大型专业生产红木家具综合企业。公司拥有多个生产基地，依托强大的研发实力和创新技术，每件家具都选材精良、做工精细。多年来，企业品牌形象已经深入人心，公司产品得到了广大消费者的认可和信赖，产品覆盖全国各大市场，并在各种全国性的展会中屡获大奖。
	      </div>
	  </div>
	
	  <div class="proModule">
	      <div class="proTop">
	        项目照片
	      </div>
	      <div class="proCon proConImg">
	        
	      </div>
	  </div>
	
	  <div class="proModule">
	      <div class="proTop">
	        资金流向
	      </div>
	      <div class="proCon">
	        <img style="width:7rem;" src="img/zjlx.png" />
	      </div>
	  </div>
  </div>
  
<!-- 未注册用户 -->
<div class="noRegistration">
   <div class="proModule">
      <div class="proTop">
        项目详情
      </div>
      <div class="proCon wzIndent">
        本项目募资客户用于企业日常运营资金周转，因短期资金周转需要借款。本计划为信用借款项目。借款人以企业收入来源及资产作为借款还款来源，向平台提交借款申请，经过多层严格审核确认发布融资，借款用途为支付货款或者经营周转。借款企业按期还款兑付。
      </div>
  </div>

  <div class="proModule">
      <div class="proTop">
        借款企业详情
      </div>
      <div class="proCon wzIndent">
        杭州**网络科技有限公司，公司的核心运营团队有来自上市公司的高管，有来自行业的业务精英，拥有强大的销售团队背景下。公司以产品质量为核心，以客户服务为中心，以强大的运营团队为基础，致力于为客户提供最优的产品和服务。
      </div>
  </div>

  <div class="proModule">
      <div class="proTop">
        风控综述
      </div>
      <div class="proCon">
        1、还款来源为该企业销售回款。<br/>
        2、一桶金风控通过对杭州**网络科技有限公司的整体运营及实力进行审核：公司的主营业务市场潜力巨大，在国内尚处于快速发展初期，且目前公司核心团队在行业属于领先地位。<br/>
        3、风控通过对杭州**网络科技有限公司的征信等资料进行审核。
      </div>
  </div>

  <div class="proModule">
      <div class="proTop">
        安全保障
      </div>
      <div class="proCon">
        1、杭州**网络科技有限公司销售回款。<br/>
        2、杭州**网络科技有限公司到期无条件担保。<br/>
      </div>
  </div>
  
  <div class="proModule">
      <div class="proTop">
        声明
      </div>
      <div class="proCon">
        一桶金拥有最终解释权。
      </div>  
  </div>
</div> 
 
<div class="tzRecond">
	<div class="proModule">
		<div class="proTop" >
	    		   <span class="itms-20" style="width: 30%;">投资用户</span>
	    		   <span class="itms-20" style="width: 30%;">投资金额</span>
	    		   <span class="itms-30" style="width: 38%;">投资时间</span>
	     </div>
		<section class=" page-wfbd">
			    <div class="flow-default" style="background: #fff;padding:0.1rem 0;" id="showtzjl">
			    </div>
		</section>
	</div>
</div>
</body>

<script type="text/javascript">
  
  $(function(){
		 
	 $(window).scroll(function(){
		 if($(window).scrollTop() > -3){
			 $(".head").css("position","fixed");
			 $(".head").css("top","0");
			 $(".head").css("left","0");
			 $(".oledpage").css("marginTop","1rem");
			 $(".registration").css("marginTop","1rem");
			 $(".oledpage").css("marginTop","1rem");
			 $(".noRegistration").css("marginTop","1rem");
		     $(".tzRecond").css("marginTop","1rem");
			 
		 }else{
			 $(".head").css("position","relative");
			 $(".head").css("z-index","99");
			 $(".registration").css("marginTop","0");
			 $(".noRegistration").css("marginTop","0");
			 $(".oledpage").css("marginTop","0");
			 $(".tzRecond").css("marginTop","0");
		 }
	 })
	
    
    
    
    //投资记录
    $("#tzjl").click(function(){
      $(window).scrollTop(0);
    	$(".registration").css("display","none");
    	$(".noRegistration").css("display","none");
    	$(".oledpage").css("display","none");
    	$(".tzRecond").css("display","block");
    	$("#xmsm").removeClass("dianji"); 
    	$("#xmsm").css("color","black");
    	$("#tzjl").addClass("dianji");
    	$("#tzjl").css("color","#FF5E33");
    });
    console.log(localStorage.getItem("uid"));
    layui.use('flow', function(){
  	  var flow = layui.flow;
  	  flow.load({
  	    elem: '#showtzjl', //流加载容器
  	    //scrollElem: '#LAY_demo1', //滚动条所在元素，一般不用填，此处只是演示需要。
  	    done: function(page, next){ //执行下一页的回调
          $.ajax({
              type: 'POST',
              url: "http://47.etongjin.net:8081/borrow/getBorrowInvestmentRecords " ,
              headers:{"uid":localStorage.getItem("uid")},
              data:{"id":localStorage.getItem("borrowId"),"page":page},
              success:function(data){
  		         setTimeout(function(){
  		         var lis = [];
               var jsonData = data;
               var jsonPac = data.data.finance;
  						 jQuery.each(jsonPac, function(i, item){
                                
  							  var name = item["username"];
  							  name = name.substring(0, 3) + "****" + name.substring(name.length-4, name.length);
  						      var ht = "<div class='row' style='line-height: 0.5rem; min-height: auto;'>";
  						      ht += "<div class='itms-20' style='width:28%;text-align: center;' >"+name+"</div>"
  						      ht += "<div class='itms-20' style='width:28%;text-align: center;'>"+item["account"]+" </div>";
  						      ht += "<div class='itms-30' style='width:42%;text-align: cneter;' >"+item["addtime"]+"</div>";
  						      ht += "</div>";
  						      lis.push(ht);
  						 });
  						 next(lis.join(''), page < jsonData.data["totalSize"]); //假设总页数为 10  jsonData["totalSize"]
  				      }, 500);
             }
        })
  	  }
  });

  });
});
</script>

</html>